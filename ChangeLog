2002-07-07  Koji Arai  <jca02266@nifty.ne.jp>

	* src/cproto.sh: added for maintainer.

	* src/lha.h: support de-ANSI variable arguments.

	* src/lharc.c: ditto.

	* src/util.c: ditto.

	* src/Makefile.am (lha_SOURCES): added prototypes.h.

	* src/lha.h: function prototyps moved to prototypes.h.

	* src/prototypes.h: generated by the cproto command.

	* configure.ac: On Mac OS X, in spite of using the CoreFoundation
	for utf-8 conversion, I have missed specifying the `-framework
	CoreFoundation' in LDFLAGS.

	* src/Makefile.am (EXTRA_DIST): no need to specify `lhdir.c'.

2002-07-06  Koji Arai  <jca02266@nifty.ne.jp>

	* configure.ac: updated version.

	* tests/lha-test10: added testing the header level 0, 1 and 2.

	* tests/lha-test.in: ditto.

	* src/lharc.c: `#include <stdarg.h>' moved to lha.h.

	* src/lha.h: ditto.

	* src/util.c: ditto.

	* configure.ac: AC_REPLACE_FUNCS(vsnprintf).

	* config.h.in: ditto.

	* src/lha.h: ditto.

	* src/vsnprintf.c: derived snprintf() which has the BSD licence.

	* configure.ac: fix typo.
	
	* configure.ac: checking whether strchr() is 8 bit clean or not.

	* config.h.in: ditto.

	* src/util.c: give functions strchr(), strrchr(), memchr() and
	memrchr() which handle 8 bit characters correctly.

	* src/header.c: use above if needed.

	* src/lha_macro.h: deprecate the macro name `DELIM2' which is path
	separattor for the filename in lha header.
	use LHA_PATHSEP instead.

	* src/util.c (convdelim): ditto.

	* src/header.c (convert_filename): ditto.
	(write_header): ditto.

	* src/header.c (convert_filename): fixed bug on utf8 conversion,
	provisionally.

2002-06-30  Koji Arai  <jca02266@nifty.ne.jp>

	* configure.ac: fixed typo.

	* src/header.c (sjis_to_utf8): fixed typo.
	(utf8_to_sjis): fixed typo.
	
	* src/lhadd.c (cmd_add): Missed to adjust the index when specified
	adding file is same as the generating archive file.

2002-06-29  Koji Arai  <jca02266@nifty.ne.jp>

	* src/header.c (convert_filename): rename a function
	`filename_conv()' to `convert_filename()'.
	(sjis_to_utf8_static): no use the static variable.
	(utf8_to_sjis_static): ditto.

	* src/lha.h: rename sjis_to_utf8_static() and utf8_to_sjis_static()
	into sjis_to_utf8() and utf8_to_sjis().

	* src/lha_macro.h: added a macro `CODE_UTF8'.

	* configure.ac: decide CODE_UTF8.
	updated version.

	* 00readme.autoconf: modified.

	* configure.ac: modified for Mac OS X.

	* src/header.c, lha.h, lha_macro.h, lharc.c: Merged a patch for
	the Mac OS X, convert utf-8 filename to shift_jis. This patch was
	contributed on LHa BBS. Thanks to Hiroto Sakai.

	* src/lhext.c: replaced bcmp() with memcmp().

	* src/lha_macro.h: ditto.

	* src/append.c: replace bcopy() with memcpy() or memmove().

	* src/lha_macro.h: ditto.

	* src/lhadd.c: ditto.

	* src/lharc.c: ditto.

	* src/header.c: ditto.
	replace bzero() with memset().

	* src/lhadd.c (cmd_add): exlclude the target archive. (reported on
	the LHa BBS [28])

	* src/slide.c (encode_alloc): Wrong value was assigned to the
	`dicbit', when SUPPORT_LH7 was not defined. (fixed by DANGAN,
	reported on the LHa BBS [38]).
	
	* src/lha_macro.h: ditto.

	* src/shuf.c (decode_c_st0): the method of -lh3- extraction was
	fixed by DANGAN (reported on the LHa BBS [35]).

	* src/lha_macro.h (LH3_DICBIT): ditto.

	* src/dhuf.c (encode_c_dyn): the method of -lh1- compression was
	refined by DANGAN (reported on the LHa BBS [30], [39], [62]).

2002-06-26  Koji Arai  <jca02266@nifty.ne.jp>

	* tests/lha-test4: Skip a test for the LHa for UNIX (original version).

	* tests/lha-test3: Rewrite tests for generic format archives.

	* tests/lha-test2: Added tests for -lh0- method.
	Moved from contents of lha-test3 (tests for print archive).

2002-06-23  Koji Arai  <jca02266@nifty.ne.jp>

	* tests/lha-test.in: On Cygwin/MinGW, cannot test lha-test9.

	* src/lhext.c: Fixed a misspelling. not `Symblic' but `Symbolic'.
	  reported on LHa BBS (see <http://www2m.biglobe.ne.jp/~dolphin/>).

	* src/lharc.c: ditto.

	* src/slide.c (interface;): Fixed wrong index.
	  reported on LHa BBS (see <http://www2m.biglobe.ne.jp/~dolphin/>).

	* 00readme.autoconf: refined.

	* tests/lha-test9: added tests for overriding files.

	* tests/lha-test.in: added test9.

	* src/lhext.c (cmd_extract): ftell(stdin) will return -1, so
	re-fixed provisionaly.

	* src/lhext.c (cmd_extract): When error occurred in extract_one(),
	should adjust point of file stream.

	* configure.ac: library checkings (for libmingwex) should be done
	before header checkings.

2002-06-22  Koji Arai  <jca02266@nifty.ne.jp>

	* released:

	* configure.ac: updated version.

	* src/lharc.c (init_variable): Removed useless assignments.

	* src/lharc.c (main): Behavior is changed. when `q' or `q2' option
	(not `q1') is specified, the `f' option is enabled implicitly.
	In original behavior, the option `q', `q0', `q1' and `q2' will
	enable `f' option implicitly (bug?).

	* src/lharc.c (main): [BUG]: When `q2' option is specified,
	level 2 header is generated.

2002-06-21  Koji Arai  <jca02266@nifty.ne.jp>

	* tests/Makefile.am: Use the `DISTCLEANFILES' variable instead of the `dist-hook' target.

	* tests/Makefile.am: Added `dist-hook' target for `make distcheck'.

	* tests/lha-test.in: All tests are splited into some files.

	* tests/Makefile.am: ditto.

	* tests/lha-test2: ditto.

	* tests/lha-test3: ditto.

	* tests/lha-test4: ditto.

	* tests/lha-test5: ditto.

	* tests/lha-test6: ditto.

	* tests/lha-test7: ditto.

	* tests/lha-test8: ditto.

2002-06-20  Koji Arai  <jca02266@nifty.ne.jp>

	* src/lhadd.c (cmd_add): No create an intermediate file when archive
	is written in stdout.

2002-06-19  Koji Arai  <jca02266@nifty.ne.jp>

	* 00readme.autoconf: Modified.

2002-06-18  Koji Arai  <jca02266@nifty.ne.jp>

	* configure.in: Removed. (no support the Autoconf version 2.13).

	* config.h.in: Changed meaning of the value of the `MULTIBYTE_FILENAME'.

	* src/header.c: Remove preprocess codes for kanji code decision.

	* configure.ac: When --enable-multibyte-filename[=auto] is specifi%d,
	decide kanji code for filename automatically.
	Otherwise, euc or sjis is specified, it is EUC-JP or Shift_JIS.

2002-06-17  Koji Arai  <jca02266@nifty.ne.jp>

	* configure.in, configure.ac: updated version.

	* configure.in, configure.ac: On mingw-runtime-2.0-1, opendir()
	has moved to libmingwex.a. For now, not listed in the
	/usr/lib/gcc-lib/i686-pc-cygwin/2.95.3-5/specs file.

	* src/lharc.c (message): use variable argument list with stdarg.
	(warning): ditto.
	(error): ditto.
	(write_error): removed.
	(read_error): removed.
	(build_temporary_name): use xsnprintf().
	(open_old_archive): ditto.
	(expanded_archive_name): move in the function (open_old_archive()) as static.

	* src/crcio.c (putcode): changed for fatal_error().
	(putbits): changed for fatal_error().
	(fwrite_crc): ditto.
	(putc_euc): should return EOF when putc() cause error.
	(fwrite_txt): changed for putc_euc().

	* src/header.c (get_header): changed for fatal_error(), warning() and error().
	(init_header): use xsnprintf().
	(write_header): fixed wrong usage of fwrite().

	* src/lha.h: updated declarations.

	* src/lhadd.c (append_it): changed for error().

	* src/lhext.c (inquire_extract): ditto.

	* src/lhlist.c (cmd_list): ditto.

	* src/maketbl.c (make_table): ditto.

	* src/util.c (copyfile): changed for fatal_error().
	(xsnprintf): newly added to adopt to various snprintf().

2002-06-12  Koji Arai  <jca02266@nifty.ne.jp>

	* src/lha_macro.h (UNIX_STICKYBIT): fixed a misspelling.

	* src/lhlist.c (list_one): ditto.

2002-06-11  Koji Arai  <jca02266@nifty.ne.jp>

	* src/lharc.c: index was wrong.
	  reported on LHa BBS (see <http://www2m.biglobe.ne.jp/~dolphin/>).

2002-06-06  Koji Arai  <jca02266@nifty.ne.jp>

	* configure.ac, configure.in: changed macro name.
	not multibyte-char but multibyte-filename.
	not MULTIBYTE_CHAR but MULTIBYTE_FILENAME.

	* 00readme.autoconf: ditto.

	* config.h.in: ditto.

	* src/util.c: ditto.

	* src/lha_macro.h: ditto.

	* src/header.c: ditto. 

	* config.h.in (INCLUDE_OWNER_NAME_IN_HEADER): changed macro name.

	* configure.ac: ditto.

	* src/header.c (init_header): ditto.

	* src/header.c (init_header): should clear LzHeader.

2002-06-05  Koji Arai  <jca02266@nifty.ne.jp>

	* released.

	* configure.ac (AC_INIT): changed package name and specified tar name.

	* src/lharc.c: added `--help' command line switch.

	* Makefile.am: fixed EXTRA_DIST for 00readme.autoconf renaming.

	* README.autoconf, 00readme.autoconf: renamed.

	* configure.ac, configure.in: updated version.

2002-06-04  Koji Arai  <jca02266@nifty.ne.jp>

	* README.autoconf, header.doc.euc: describe about user/group name
	header.

	* src/header.c (init_header): added a macro MAKE_USER_NAME_HEADER.

	* configure.ac, configure.in, config.h.in: added a switch
	`--enable-user-name-header' whether user/name extended header is
	made.

2002-06-01  Koji Arai  <jca02266@nifty.ne.jp>

	* README.autoconf: `-i' switch of automake is deprecated.

2002-05-29  Koji Arai  <jca02266@nifty.ne.jp>

	* configure.in, configure.ac, config.h.in: checks having uid_t/gid_t.

	* src/lha.h: define uid_t/gid_t as `int' if no have it.

	* src/lhext.c (adjust_info): mismatched braces.

	* header.doc.euc: around user/group name extention.

	* configure.in, configure.ac, config.h.in: checks having
	getpwuid/getgrgid and so on.

	* src/header.c (get_header): use the extend header, user/group name.
	(init_header): ditto.

	* src/lha.h: added <pwd.h>, <grp.h> header includings.

	* src/lhext.c (adjust_info): change owner/group according to
	user/group name when extracting.

	* src/lhlist.c (list_one): print user/group name when the header
	has them.
	(list_one): correct column position on OS68K.

	* tests/lha-test.in: added timestamp checks.

	* src/lha_macro.h: comment about OS code.

2002-05-28  Koji Arai  <jca02266@nifty.ne.jp>

	* src/lharc.c (xstrdup): no need to call fatal_error().

	* src/lhdir.h, src/lha_macro.h, src/lha.h: added modeline for vi(m).

	* configure.ac, config.h.in: use new autoconf macro, AC_CHECK_MEMBERS().

	* IFNAMES, configure.in, src/header.c, src/lharc.c: replaced with
	new macro name to adopt to the AC_CHECK_MEMBERS().

2002-05-27  Koji Arai  <jca02266@nifty.ne.jp>

	* tests/lha-test.in: use awk instead of GNU sh-utils's `seq'.

	* src/header.c (filename_conv): fix a bug, reverse condition and
	conversion for filename case.

	* README.autoconf: added description about `get_filename_from_stdin' feature.

	* tests/lha-test.in: remove test around the `get_filename_from_stdin'.

	* src/lharc.c (main): never set `get_filename_from_stdin` to true.
	`echo foo | lha x foo.lzh' does not work like original LHa for UNIX.

	* tests/lha-test.in: replace with #!/bin/bash.

	* README.autoconf: added E-Mail address.

	* configure.ac: updated version and added mail address for bug reports.

	* configure.in: updated version.

	* released.

	* README.autoconf: added `make check' on sample description.

	* configure.in, configure.ac: update version.

2002-05-26  Koji Arai  <jca02266@nifty.ne.jp>

	* tests/lha-test.in: added some tests.

	* tests/Makefile.am: refined.

	* src/lhext.c (cmd_extract): discard useless fseek() calling (for MinGW).

	* tests/lha-test.in: added some tests.

	* tests/lha-test.in: specified `q' option on print archive test.

	* src/lhadd.c (build_backup_file): On MinGW, cannot rename when
	a new file already exists.

	* src/lhext.c (extract_one): On MinGW, set binary on stdout when
	print archive (`p' switch).

	* tests/lha-test.in: added some tests.

	* src/lhadd.c (report_archive_name_if_different): warning messages
	should be printed to stderr rather than stdout.
	(cmd_delete): ditto.

	* tests/Makefile.am: fix EXTRA_DIST.

	* configure.in, configure.ac: update version.

	* tests/lha-test.in: added tests.

	* tests/Makefile.am: ditto.

	* configure.in, configure.ac, Makefile.am: ditto.

2002-05-25  Koji Arai  <jca02266@nifty.ne.jp>

	* IFNAMES: updated.

	* released.

	* README.autoconf: added description for developpers.

	* configure.in, configure.ac, config.h.in: refined.

	* src/util.c (memmove): use HAVE_MEMMOVE.
	(mkdir): use HAVE_WORKING_FORK.

	* src/huf.c: use HAVE_SYS_PARAM_H instead of sony_news.

	* IFNAMES (sony_news): updated.

	* configure.ac, configure.in (AC_INIT): added autoconfiscated date.
	see `lha --version'.

2002-05-22  Koji Arai  <jca02266@nifty.ne.jp>

	* src/append.c, src/crcio.c, src/dhuf.c, src/extract.c, src/header.c, src/huf.c, src/larc.c, src/lhadd.c, src/lharc.c, src/lhdir.c, src/lhext.c, src/lhlist.c, src/maketbl.c, src/maketree.c, src/patmatch.c, src/shuf.c, src/slide.c, src/util.c:
	added modeline for vi(m).

	* src/lharc.c: backslash was missing.

2002-05-20  Koji Arai  <jca02266@nifty.ne.jp>

	* src/lharc.c (open_old_archive):  On MinGW, set binary stdin.

	* src/lhadd.c (temporary_to_new_archive_file): On MinGW, set binary stdout.

	* src/lha_macro.h: no define TMP_FILENAME_TEMPLATE in source.

	* configure.ac, configure.in, README.autoconf: be able to specify
	--with-tmp-file=no which meaning TMP_FILENAME_TEMPLATE is undefined.

	* src/lha.h: correct usage of mkstemp().
	On MinGW, opening file cannot be removed.

	* src/lhadd.c (build_temporary_file): ditto.

	* src/lharc.c (fatal_error): ditto.

2002-05-19  Koji Arai  <jca02266@nifty.ne.jp>

	* configure.in, configure.ac: added AM_C_PROTOTYPES, AC_C_CONST.
	no use AM_C_PROTOTYPES for the present.

	* config.h.in: ditto.

	* src/lharc.c (print_tiny_usage_and_exit): change credit.

	* src/lha_macro.h: put PLATFORM in a macro LHA_VERSION.

	* src/lharc.c (print_version): ditto.

	* configure.ac: use AC_CANONICAL_TARGET instead of AC_CANONICAL_HOST.

2002-05-19  Koji Arai  <jca02266@nifty.ne.jp>

	* released.

	* src/lharc.c (print_tiny_usage_and_exit): added credit.
	(print_version): print PLATFORM.

	* configure.ac, configure.in, config.h.in: define PLATFORM.

	* src/lharc.c (xstrdup): fix typo.

	* configure.ac: added for autoconf-2.53.

	* config.h.in: regenerate by autoconf-2.53.

	* src/lharc.c (find_files): MinGW has st_ino but always 0.

	* src/lharc.c (main): provisionally fix. set
	`get_filename_from_stdin' to false.

	* src/util.c (rename): use builtin rename(2) on mingw32 (since have
	no link(2)).

	* src/lharc.c (main): use xrealloc().

	* src/lha_macro.h: specify "b" modifier always (for mingw32).

	* src/lharc.c: use xstrdup() instead of strdup().

	* src/lha_macro.h: ditto.

	* src/lha_macro.h: getuid(), chown(), kill() are provisionally
	defined as 0.

	* src/header.c: set `default_system_kanji_code' to Shift_JIS on mingw32.

	* src/lhadd.c (build_temporary_file): no use SIGHUP for mingw32.
	(build_backup_file): ditto.

	* src/lharc.c (interrupt): ditto.

	* src/lhext.c (extract_one): ditto.

	* src/lhext.c (make_parent_path): mkdir() has no 2nd argument on
	mingw32.

2002-05-18  Koji Arai  <jca02266@nifty.ne.jp>

	* lha_macro.h: define bcmp(), bzero(), bcopy() even if
	STDC_HEADERS is defined.

	* huf.c (alloc_buf): call fatal_error() when memory allocation failed
	instead of returning NULL.

	* lharc.c (main): use xmalloc().

	* util.c (copyfile): use xmalloc().

	* slide.c (encode_alloc): use xmalloc().

	* header.c (default_system_kanji_code): On HP-UX, use Shift_JIS as
	default kanji code.

2001-02-03  Koji Arai  <jca02266@nifty.ne.jp>

	* README.autoconf, src/header.c: treat archive and system kanji
	code, correctly.

2001-01-31  Koji Arai  <jca02266@nifty.ne.jp>

	* configure.in: mistakes for default archive method.

	* src/header.c: directory separator 0xff must be transpose slash
	at first.

2001-01-29  Koji Arai  <jca02266@nifty.ne.jp>

	* src/lharc.c: replace MKSTEMP with HAVE_MKSTEMP.
	substitute DEFAULT_LZHUFF_METHOD for the `compress_method' variable (it's default value).

	* src/lha_macro.h: use the VERSION macro (defined by configure) for
	the LHA_VERSION definition.

	* src/header.c: added condition whether the macro MULTIBYTE_CHAR
	is defined or not.

	* src/Makefile.am: added $(SUPPORT_LZHUFF_METHOD) in AM_CPPFLAGS.

	* configure.in: change version number from 1.14f to 1.14i.
	check function mkstemp().
	replace --enable-lh6 option to --with-default-method=[567].

	* config.h.in: added definitions of HAVE_MKSTEMP and
	DEFAULT_LZHUFF_METHOD.

	* IFNAMES: added a description about MKSTEMP.

	* Makefile.am: added extra files.

	* change-114f.txt, src/extract.c, src/header.c, src/huf.c, src/lha.h, src/lha_macro.h, src/lhadd.c, src/lharc.c, src/lhext.c, src/lhlist.c, src/maketbl.c, src/maketree.c, src/shuf.c, src/slide.c, src/util.c, src/dhuf.c, src/crcio.c:
	merged changing from lha-1.14f to lha-1.14i.

	* change-114i.txt, src/header.c, src/huf.c, src/lha.h, src/lharc.c:
	import lha-114i

	* src/huf.c, src/lharc.c, src/shuf.c, src/slide.c: import lha-114h

	* Makefile, README.euc, change-114g.txt, change-114h.txt:
	import lha-114h

	* src/crcio.c, src/dhuf.c, src/extract.c, src/header.c, src/huf.c, src/lha.h, src/lha_macro.h, src/lhadd.c, src/lharc.c, src/lhext.c, src/util.c:
	import lha-114g

	* MACHINES2.euc, Makefile, README.euc, change-114g.txt, config.eng, config.jpn.euc, header.doc.euc, src/lhlist.c, src/maketbl.c, src/maketree.c, src/makezero.c, src/shuf.c, src/slide.c:
	import lha-114g

	* src/header.c, src/lha_macro.h: implemented kanji code conversion
	on filename.

	* src/header.c: fix bug in euc2sjis().

1999-10-05  Koji Arai  <jca02266@nifty.ne.jp>

	* src/header.c: rename the macro HANKAKU_KATAKANA_P to the X0201_KANA_P

1999-09-30  Koji Arai  <jca02266@nifty.ne.jp>

	* IFNAMES, configure.in, Makefile.in.org, README.autoconf, config.h.in, man/Makefile.am, src/Makefile.am, src/Makefile.in.org, Makefile.am, src/header.c, src/huf.c, src/larc.c, src/lha.h, src/lha_macro.h, src/lhadd.c, src/lharc.c, src/lhdir.c, src/lhdir.h, src/lhext.c, src/lhlist.c, src/makefile.dj, src/maketbl.c, src/maketree.c, src/patmatch.c, src/shuf.c, src/slide.c, src/util.c, Makefile, man/Makefile, src/Makefile, src/append.c, src/crcio.c, src/dhuf.c, src/extract.c:
	use the autoconf/automake

1999-08-28  Koji Arai  <jca02266@nifty.ne.jp>

	* Makefile: import the lha-114f

	* change-114f.txt, config.jpn.euc, header.doc.euc: import the lha-114f

	* CHANGES.euc, MACHINES.euc, PROBLEMS.euc, README.euc, change-114e.txt, config.eng:
	import the lha-114f

	* MACHINES2.euc, man/Makefile, man/lha.man, man/lha.n:
	import the lha-114f

	* src/append.c, src/crcio.c: import the lha-114f

	* src/Makefile, src/lha.h, src/lha_macro.h, src/lharc.c, src/lhdir.c, src/lhdir.h, src/lhext.c, src/lhlist.c, src/makefile.dj, src/maketbl.c, src/maketree.c, src/patmatch.c, src/shuf.c, src/slide.c, src/util.c:
	import the lha-114f

	* src/dhuf.c, src/extract.c, src/header.c, src/huf.c, src/larc.c, src/lhadd.c:
	import the lha-114f
